<!DOCTYPE html>

<html>

<head>

    <meta charset="utf-8">

    <title>layui</title>

    <meta name="renderer" content="webkit">

    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <link href="~/Content/layui/css/layui.css" rel="stylesheet" />


    <!-- 注意：如果你直接复制所有代码到本地，上述css路径需要改成你本地的 -->

    <style type="text/css">

        .layui-table-cell {
            height: 50px;
        }
    </style>


</head>


<body>

    <div style="width:1150px;height:80px;border:1px solid  red">
        <div class="layui-form-item" style="width:300px;">
            <label class="layui-form-label">相册分类</label>
            <div class="layui-input-block">
                <select name="ImgType" id="ImgType" lay-filter="aihao" lay-verify="required">
                    <option value=""></option>
                    <option value="1">三国杀</option>
                    <option value="2">天行九歌</option>
                    <option value="3">游戏</option>
                    <option value="4">音乐</option>
                    <option value="5">其他</option>
                </select>
            </div>
        </div>
        <button class="layui-btn layui-btn-sm" lay-event="getCheckData">批量删除</button>

        <button class="layui-btn layui-btn-sm" lay-event="getCheckLength">开启过滤行</button>

        <button class="layui-btn layui-btn-sm" lay-event="isAll">导出Excel</button>



        <div class="layui-input-block">
            <select name="city" lay-verify="required">
                <option value=""></option>
                <option value="0">北京</option>
                <option value="1">上海</option>
                <option value="2">广州</option>
                <option value="3">深圳</option>
                <option value="4">杭州</option>
            </select>
        </div>

    </div>

    <table class="layui-hide" id="test" lay-filter="test" style="z-index:10;"></table>



    <script type="text/html" id="barDemo">

        <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>

        <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>

    </script>

    <!-- 注意：如果你直接复制所有代码到本地，上述js路径需要改成你本地的 -->
    <script src="~/Content/layui/layui.all.js"></script>

</body>
<script>

    layui.use(['form', 'layedit', 'table'], function () {
        var table = layui.table;
        var form = layui.form;
        form.on('select(aihao)', function (data) {
            job = data.value;
            form.render('select');
            console.log(data.elem) //被执行事件的元素DOM对象，一般为button对象
            console.log(data.form) //被执行提交的form对象，一般在存在form标签时
        });


        var $ = layui.jquery;

        table.render({

            elem: '#test',

            width: '1150'

            , url: 'http://localhost:1208/api/table/'



            , title: '用户数据表'

            , height: 'full-20',
            id: 'idTest'

            , cols: [[

                { field: 'Id', type: 'checkbox', width: 50, fixed: 'left' }

                , { field: 'Name', title: '相册名称', width: 100, edit: 'text' }

                , { field: 'TypeName', title: '类型', width: 100, edit: 'text' }

                , { field: 'Comment', title: '备注', width: 350, sort: true, totalRow: true }

                , { field: 'ImgCount', title: '照片数量', width: 120, edit: 'text', sort: true }

                , {

                    field: 'fisrtImg', title: '封面', width: 120, totalRow: true, templet: function (d) {
                        return "<img src='/" + d.fisrtImg + "' />";
                    }

                }

                , { field: 'createtime', title: '创建时间', width: 150, sort: true, totalRow: true }

                , {
                    field: 'Id', title: '操作', width: 150, sort: true, totalRow: true, toolbar: '#barDemo'
                }

            ]

            ]

            , page: true

        });

        //头工具栏事件

        /* table.on('toolbar(test)', function (obj) {

             var checkStatus = table.checkStatus(obj.config.id);
             var tabledata = obj.data;
             switch (obj.event) {

                 case 'getCheckData':


                     layer.confirm('真的删除行么', function (index) {




                         var data = checkStatus.data;

                         var ids = "";

                         $.each(data, function (i, e) {

                             ids += e.Id + ',';
                             alert(ids)
                         })
                         layer.close(index);
                         $.ajax({

                             data: { id: ids },

                             type: 'post',

                             dataType: 'text',

                             url: '/img/DelTable',

                             success: function (data) {
                                 alert(1)

                                 layer.msg(data)

                                 table.reload(

                                     'idTest', {

                                         url: 'http://localhost:1208/api/table/'

                                     }

                                 )

                             }

                         });


                     });
                     break;

                 case 'getCheckLength':

                     var data = checkStatus.data;

                     layer.msg('选中了：' + data.length + ' 个');

                     break;

                 case 'isAll':

                     layer.msg(checkStatus.isAll ? '全选' : '未全选');

                     break;

             };

         });*/

        //监听行工具事件

        table.on('tool(test)', function (obj) {

            var data = obj.data;

            //console.log(obj)

            if (obj.event === 'del') {

                layer.confirm('真的删除行么', function (index) {

                    obj.del();

                    layer.close(index);

                });

            } else if (obj.event === 'edit') {

                layer.prompt({

                    formType: 2

                    , value: data.email

                }, function (value, index) {

                    obj.update({

                        email: value

                    });

                    layer.close(index);

                });

            }

        });

    });

</script>
</html>